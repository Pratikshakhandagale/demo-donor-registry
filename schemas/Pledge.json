{
  "$schema": "http://json-schema.org/draft-07/schema",
  "type": "object",
  "properties": {
    "Pledge": {
      "$ref": "#/definitions/Pledge"
    }
  },
  "required": [
    "Pledge"
  ],
  "title":"Pledge",
  "definitions": {
    "Pledge": {
      "$id": "#/properties/Pledge",
      "type": "object",
      "title": "The Pledge Schema",
      "required": [

      ],
      "properties": {
        "personalDetails": {
          "type": "object",
          "additionalProperties": false,
          "title": "Personal Details",
          "required": ["name", "fatherName", "dob", "gender", "emailId", "mobileNumber"],
          "properties": {
            "name": {
              "type": "string",
              "title": "Donor Name* (First Name+Middle Name+Last Name)"
            },
            "fatherName": {
              "type": "string",
              "title": "Father’s/Husband’s Name"
            },
            "dob": {
              "type": "string",
              "format": "date",
              "title": "Date of Birth"
            },
            "gender": {
              "type": "string",
              "enum": ["Male","Female", "Transgender"],
              "title": "Gender"
            },
            "bloodGroup": {
              "type": "string",
              "enum": ["A+","A-","B+","B-","AB+","AB-","O+","O-"],
              "title": "Blood Group"
            },
            "emailId": {
              "type": "string",
              "format": "email",
              "title": "Email Id"
            },
            "mobileNumber": {
              "type": "string",
              "pattern": "^[6-9]\\d{9}$",
              "title": "Mobile Number"
            }
          }
        },
        "identificationDetails": {
          "type": "object",
          "additionalProperties": false,
          "required": ["proof", "number"],
          "title": "Identification Details",
          "properties": {
            "proof": {
              "type": "string",
              "enum": ["Aadhaar", "Pan Card", "Abha ID"],
              "title": "Identification Proof"
            },
            "number": {
              "type": "string",
              "title": "Identification Number"
            }
          }
        },
        "addressDetails": {
          "type": "object",
          "additionalProperties": false,
          "required": ["addressLine1", "country", "state", "district", "pincode"],
          "title": "Address Details",
          "allOf": [{"$ref": "Common.json/#/definitions/addressDetails"}]
        },
        "pledgeDetails": {
          "type": "object",
          "additionalProperties": false,
          "required": ["organs", "tissues"],
          "title": "Pledge Details",
          "properties": {
            "organs": {
              "type": "array",
              "items": {
                "type": "string",
                "enum": ["Liver","Kidney","Heart","Intestine","Pancreas","Lungs"]
              },
              "title": "Organs to Pledge"
            },
            "tissues": {
              "type": "array",
              "items": {
                "type": "string",
                "enum": ["Bone","Heart Valve","Skin","Cornea","Cartilage","Blood Vessels"]
              },
              "title": "Tissues to Pledge"
            },
            "other": {
              "type": "string",
              "title": "Other Organs/Tissues"
            }
          }
        },
        "emergencyDetails": {
          "type": "object",
          "additionalProperties": false,
          "required": [],
          "title": "Emergency Contact Details",
          "properties": {
            "name": {
              "type": "string"
            },
            "relation": {
              "type": "string",
              "enum": ["Father", "Mother"]
            },
            "email": {
              "type": "string",
              "format": "email"
            }
          },
          "allOf": [{
            "$ref": "Common.json/#/definitions/addressDetails"
          }
          ]
        },
        "witnessDetails": {
          "type": "array",
          "title": "Witness Details",
          "maxItems": 2,
          "items": {
            "type": "object",
            "additionalProperties": false,
            "required": [],
            "properties": {
              "name": {
                "type": "string"
              },
              "fatherName": {
                "type": "string",
                "title": "Father’s/Husband’s Name"
              },
              "dob": {
                "type": "string",
                "format": "date",
                "title": "Date of Birth"
              },
              "relation": {
                "type": "string",
                "enum": ["Father", "Mother"]
              },
              "email": {
                "type": "string",
                "format": "email"
              },
              "mobileNumber": {
                "type": "string",
                "pattern": "^[6-9]\\d{9}$",
                "title": "Mobile Number"
              }
            },
            "allOf": [{
              "$ref": "Common.json/#/definitions/addressDetails"
            }
            ]
          }
        }
      }
    }
  },
  "_osConfig": {
    "osComment": ["This section contains the OpenSABER specific configuration information",
      "privateFields: Optional; list of field names to be encrypted and stored in database",
      "signedFields: Optional; list of field names that must be pre-signed",
      "indexFields: Optional; list of field names used for creating index. Enclose within braces to indicate it is a composite index. In this definition, (serialNum, studentCode) is a composite index and studentName is a single column index.",
      "uniqueIndexFields: Optional; list of field names used for creating unique index. Field names must be different from index field name",
      "systemFields: Optional; list of fields names used for system standard information like created, updated timestamps and userid"],

    "privateFields": [
      "$.identityDetails.dob",
      "$.identityDetails.identityType",
      "$.identityDetails.identityValue",
      "$.contactDetails.email",
      "$.contactDetails.mobile",
      "$.contactDetails.address.plot",
      "$.contactDetails.address.street",
      "$.contactDetails.address.landmark",
      "$.contactDetails.address.locality"
    ],
    "indexFields": ["studentName"],
    "uniqueIndexFields": ["identityValue"],
    "systemFields": [
      "osCreatedAt",
      "osUpdatedAt",
      "osCreatedBy",
      "osUpdatedBy"
    ],
    "attestationPolicies": [
      {
        "name": "studentInstituteAttest",
        "additionalInput": {
          "enrollmentNumber": {"type": "string"}
        },
        "attestationProperties": {
          "name": "$.identityDetails.fullName",
          "educationDetails": "$.educationDetails"
        },
        "type": "MANUAL",
        "conditions": "(ATTESTOR#$.experience.[*].instituteOSID#.contains(REQUESTER#$.educationDetails.*.instituteOSID#))",
        "attestorPlugin": "did:internal:ClaimPluginActor?entity=Teacher"
      }
    ],
    "inviteRoles":["Teacher"],
    "ownershipAttributes": [
      {
        "email": "/contactDetails/email",
        "mobile": "/contactDetails/mobile",
        "userId": "/contactDetails/mobile"
      }
    ]
  }
}
